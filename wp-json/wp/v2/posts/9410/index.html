{"id":9410,"date":"2019-10-25T16:14:59","date_gmt":"2019-10-25T19:14:59","guid":{"rendered":"http:\/\/blog.plataformatec.com.br\/?p=9410"},"modified":"2019-11-18T15:17:29","modified_gmt":"2019-11-18T17:17:29","slug":"monte-carlo-in-practice-finding-the-ideal-iteration-value","status":"publish","type":"post","link":"http:\/\/blog.plataformatec.com.br\/2019\/10\/monte-carlo-in-practice-finding-the-ideal-iteration-value\/","title":{"rendered":"Monte Carlo in Practice: Finding the ideal iteration value"},"content":{"rendered":"\n<p>One of the reasons to use any kind of project management methodology is to reduce costs.<\/p>\n\n\n\n<p>A delay in a single week of a project creates two different cost types:<\/p>\n\n\n\n<ul><li>The first is the cost of the team, since they will need to work another week.<\/li><li>The second is the Cost of Delay, which is the income not collected due to the delay. For instance, suppose the new feature this team is working on would generate a daily income of&nbsp;<strong>$100<\/strong>, the Cost of Delay would be&nbsp;<strong>$700<\/strong>&nbsp;($100 * 7 days).<\/li><\/ul>\n\n\n\n<p>Since these costs can be high, using tools that provide more visibility on delivery dates is necessary. One tool that can help solve this problem is the Gantt Chart. With the Gantt Chart it\u2019s possible to identify the most frail points of the project (the critical path) where more effort should be made to prevent delays, since a delay in any step of those points will impact the project as a whole.<\/p>\n\n\n\n<p>Even though this tool is great for some types of projects (normally when there is a low uncertainty level), it\u2019s not ideal for projects where the predictability is low due to the&nbsp;<a href=\"https:\/\/en.wikipedia.org\/wiki\/Variance\" target=\"_blank\" rel=\"noreferrer noopener\" aria-label=\" (opens in a new tab)\">variance<\/a>&nbsp;of the deliverables, as in projects that happen in the field of knowledge (writing a book or software development, for example).<\/p>\n\n\n\n<p>Here at Plataformatec, we have always done our best to make our delivery predictions based on data and ensure they follow proven scientific methodology. The two methods we use the most are:<\/p>\n\n\n\n<ul><li>Linear Progression<\/li><li>Monte Carlo Simulation<\/li><\/ul>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"linear--progression\">LINEAR PROGRESSION<\/h2>\n\n\n\n<p>In linear progression, we do data analysis on the delivered work items during some time period (in software development we normally work with weeks) and through the study of this information we come up with the best values for the progression. For example: suppose we have the following historic values of work items by week, as shown below:<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"445\" src=\"http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/11\/tp_table-1024x445.png\" alt=\"\" class=\"wp-image-9549\" srcset=\"http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/11\/tp_table-1024x445.png 1024w, http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/11\/tp_table-300x130.png 300w, http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/11\/tp_table-768x334.png 768w, http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/11\/tp_table-1536x668.png 1536w, http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/11\/tp_table.png 1804w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/figure>\n\n\n\n<p>A value that could be used as a&nbsp;<strong>pessimistic<\/strong>&nbsp;projection would be to assume a delivery of&nbsp;<strong>1<\/strong>&nbsp;work item per week, seeing as we\u2019ve had 5 cases where the throughput was&nbsp;<strong>1<\/strong>&nbsp;or&nbsp;<strong>0<\/strong>. For the&nbsp;<strong>optimist<\/strong>&nbsp;projection we could use either the value of&nbsp;<strong>3<\/strong>&nbsp;or&nbsp;<strong>4<\/strong>, or even&nbsp;<strong>3.5<\/strong>, as we\u2019ve had 4 instances where the throughput was&nbsp;<strong>3 or higher<\/strong>. Lastly, for the&nbsp;<strong>likely<\/strong>&nbsp;projection, a good value would be&nbsp;<strong>2<\/strong>, as it\u2019s the&nbsp;<strong>median<\/strong>&nbsp;and the&nbsp;<strong>mode<\/strong>&nbsp;of this dataset.<\/p>\n\n\n\n<p>The biggest problem with the linear progression is that we are inputting the values for each scenario, something that can be dangerous if the person operating the linear progression doesn\u2019t have a good grasp of data analytics. Furthermore, linear progression ignores variance. Thus, in work systems with high variance of deliveries, the linear progression tool might not be the best approach.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"monte--carlo\">MONTE CARLO<\/h2>\n\n\n\n<p>Another technique we can use is called&nbsp;<strong><a href=\"https:\/\/en.wikipedia.org\/wiki\/Monte_Carlo_method\" target=\"_blank\" rel=\"noreferrer noopener\" aria-label=\" (opens in a new tab)\">Monte Carlo<\/a><\/strong>, which runs random picks from our historic throughput data to try and find the likelihood of delivery.<\/p>\n\n\n\n<p>I\u2019m having success using this method, however a question that keeps coming to my mind is: \u201cHow many interactions are necessary to make the method statistically valuable and the results reliable?\u201d. Looking for an answer to this question, I\u2019ve researched some statistics books, and also the internet, but wasn\u2019t able to find any information that would help.<\/p>\n\n\n\n<p>So I decided to run a study on this subject. Monte Carlo\u2019s objective is to infer the probability of an event, \u201cforcing\u201d it to happen so many times, in order to use the&nbsp;<a href=\"https:\/\/en.wikipedia.org\/wiki\/Law_of_large_numbers\">law of large numbers<\/a>&nbsp;in our favor. For example, if you flip a coin a thousand times, count how many times it falls as \u201cheads\u201d, and divide by a thousand, you will get an inference of the probability of getting \u201cheads\u201d.<\/p>\n\n\n\n<p>To check the quality of the method, I first ran tests over probabilities for which I already knew the expected results. After that, I started increasing the complexity of the problem, in order to see if there was any correlation between the difficulty of a problem and the number of interactions necessary for the inferred value from Monte Carlo to be as close as possible to the calculated one.<\/p>\n\n\n\n<p>The objective of the tests is to see how many interactions are necessary for the inferred value to be close enough to the calculated value that the gain of running more interactions would be too low to compensate the computer power necessary to run it (for a project probability standpoint an error in the first or second decimal values would be acceptable). I\u2019d like to highlight that this blog post is not a scientific study of the subject, and the objective is to understand through inference a good value for project predictions.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"the--tests\">THE TESTS<\/h2>\n\n\n\n<p>The tests were performed using the programing language&nbsp;<strong>R<\/strong>, which can be downloaded in this&nbsp;<a rel=\"noreferrer noopener\" aria-label=\" (opens in a new tab)\" href=\"https:\/\/www.r-project.org\/\" target=\"_blank\">link<\/a>. If you would rather use an IDE, I recommend using&nbsp;<a href=\"https:\/\/www.rstudio.com\/\" target=\"_blank\" rel=\"noreferrer noopener\" aria-label=\" (opens in a new tab)\">RStudio<\/a>.<\/p>\n\n\n\n<p>In each test, I\u2019ve run the algorithm&nbsp;<strong>100<\/strong>&nbsp;times using the following interaction values:&nbsp;<strong>100<\/strong>&nbsp;(one hundred),&nbsp;<strong>1000<\/strong>&nbsp;(one thousand),&nbsp;<strong>10000<\/strong>&nbsp;(ten thousand),&nbsp;<strong>100000<\/strong>&nbsp;(one hundred thousand),&nbsp;<strong>1000000<\/strong>&nbsp;(one million),&nbsp;<strong>10000000<\/strong>&nbsp;(ten million),&nbsp;<strong>100000000<\/strong>&nbsp;(one hundred million) e&nbsp;<strong>200000000<\/strong>&nbsp;(two hundred million). The results of these 100 &#8220;rounds&#8221; are then consolidated.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\" id=\"the--coin\">THE COIN<\/h3>\n\n\n\n<p>The first test that I\u2019ve run was the flipping of a single coin. In a coin flip, there is a&nbsp;<strong>50%<\/strong>&nbsp;chance of it landing on any side, and this is the value we want the Monte Carlo to infer. For that I\u2019ve used the following R code:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-1\" data-shcb-language-name=\"PHP\" data-shcb-language-slug=\"php\"><div><code class=\"hljs language-php\">\nFLipCoin  &lt;-  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function<\/span><span class=\"hljs-params\">(iterations)<\/span>\n<\/span>{\n  <span class=\"hljs-comment\"># Creates  a  vector  with  the  possible  values  for  a  coin  1  =  Heads  and  0  =  Tails<\/span>\n  coin  =  c(<span class=\"hljs-number\">0<\/span>,<span class=\"hljs-number\">1<\/span>)\n  result  =  <span class=\"hljs-number\">0<\/span>\n\n  <span class=\"hljs-comment\"># Flips  a  number  of  coins  equal  to  the  interaction  value  and  sum  up  all  the  times  where  the  coin  landed  in  \"Heads\"<\/span>\n  result  =  sum(sample(coin,  iterations,  replace=T))\n\n  <span class=\"hljs-comment\"># Turns  the  value  in  a  percentage  of  the  coin  flips<\/span>\n  result  =  (result\/iterations)  *  <span class=\"hljs-number\">100<\/span>\n\n  <span class=\"hljs-keyword\">return<\/span>(result)\n}\n\n<span class=\"hljs-comment\"># Initiates  variables<\/span>\nresult_vector  =  <span class=\"hljs-number\">0<\/span>\ntime_vector  =  <span class=\"hljs-number\">0<\/span>\ncontrol  =  <span class=\"hljs-number\">0<\/span>\n\n<span class=\"hljs-comment\"># Controls  the  interaction  quantity<\/span>\niterations  =  <span class=\"hljs-number\">100<\/span>\n\n<span class=\"hljs-comment\"># Alocates  the  percentual  of  \"Heads\"  results  in  a  100  size  vector  and  the  execution  time  in  another<\/span>\n<span class=\"hljs-keyword\">while<\/span>(control  !=  <span class=\"hljs-number\">100<\/span>)\n{\n  start_time  =  Sys.time()\n  result_vector  =  append(result_vector,  FLipCoin(iterations))  \n  finish_time  =  Sys.time()\n\n  time  =  finish_time  -  start_time\n  time_vector  =  append(time_vector,  time)  \n\n  control  =  control  +  <span class=\"hljs-number\">1<\/span>\n}\n\n<span class=\"hljs-comment\"># Shows  the  percentual  of  \"Heads\"<\/span>\nresult_vector\n\n<span class=\"hljs-comment\"># Shows  the  execution  times<\/span>\ntime_vector\n\n<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-1\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">PHP<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">php<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Changing the values of the iterations and compiling the results, I\u2019ve got the following table:<\/p>\n\n\n\n<ul><li> \n<table id=\"tablepress-12\" class=\"tablepress tablepress-id-12\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Iterations<\/th><th class=\"column-2\">Min result<\/th><th class=\"column-3\">Max result<\/th><th class=\"column-4\">Expected result<\/th><th class=\"column-5\">Average result<\/th><th class=\"column-6\">Average result - Expected result<\/th><th class=\"column-7\">Result's median<\/th><th class=\"column-8\">Result's median - Expected<\/th><th class=\"column-9\">result | Result's   Standard deviation<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">33.00000<\/td><td class=\"column-3\">67.00000<\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.02000 <\/td><td class=\"column-6\">0.02000 <\/td><td class=\"column-7\">50.00000 <\/td><td class=\"column-8\">0.00000 <\/td><td class=\"column-9\">5.09368 <\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">43.60000<\/td><td class=\"column-3\">56.20000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99440 <\/td><td class=\"column-6\">0.00560 <\/td><td class=\"column-7\">50.00000 <\/td><td class=\"column-8\">0.00000 <\/td><td class=\"column-9\">1.59105 <\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">48.35000<\/td><td class=\"column-3\">51.78000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.01263 <\/td><td class=\"column-6\">0.01263 <\/td><td class=\"column-7\">50.02000 <\/td><td class=\"column-8\">0.02000 <\/td><td class=\"column-9\">0.51001 <\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">49.58000<\/td><td class=\"column-3\">51.78000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99110 <\/td><td class=\"column-6\">0.00890 <\/td><td class=\"column-7\">49.99350 <\/td><td class=\"column-8\">0.00650 <\/td><td class=\"column-9\">0.15805 <\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">49.85170<\/td><td class=\"column-3\">50.15090 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99883 <\/td><td class=\"column-6\">0.00117 <\/td><td class=\"column-7\">49.99785 <\/td><td class=\"column-8\">0.00215 <\/td><td class=\"column-9\">0.04811 <\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">49.95433 <\/td><td class=\"column-3\">50.05807 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.00013 <\/td><td class=\"column-6\">0.00013 <\/td><td class=\"column-7\">50.00010 <\/td><td class=\"column-8\">0.00010 <\/td><td class=\"column-9\">0.01564 <\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">49.98435 <\/td><td class=\"column-3\">50.01637 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.00004 <\/td><td class=\"column-6\">0.00004 <\/td><td class=\"column-7\">49.99989 <\/td><td class=\"column-8\">0.00011 <\/td><td class=\"column-9\">0.00516 <\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">49.98890<\/td><td class=\"column-3\">50.01195 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99981 <\/td><td class=\"column-6\">0.00019 <\/td><td class=\"column-7\">49.99987 <\/td><td class=\"column-8\">0.00013 <\/td><td class=\"column-9\">0.00345 <\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-12 from cache --> <\/li><\/ul>\n\n\n\n<p>In the instance of a simple problem, like the flipping of a single coin, we can see that a good iteration value could be:<\/p>\n\n\n\n<ul><li>between&nbsp;<strong>10M<\/strong>&nbsp;and&nbsp;<strong>100M<\/strong>&nbsp;if you are ok with having an error in the&nbsp;<strong>third decimal<\/strong>,<\/li><li>between&nbsp;<strong>100k<\/strong>&nbsp;and&nbsp;<strong>1M<\/strong>&nbsp;in the&nbsp;<strong>second decimal<\/strong><\/li><li>between&nbsp;<strong>1k<\/strong>&nbsp;and&nbsp;<strong>10k<\/strong>&nbsp;in the&nbsp;<strong>first decimal<\/strong>.<\/li><\/ul>\n\n\n\n<h3 class=\"wp-block-heading\" id=\"one--die\">ONE DICE<\/h3>\n\n\n\n<p>With the coin test it was possible to infer the number of necessary interactions, based on the desired degree of reliability. However a question remains regarding if this behavior changes for more complex problems. Because of that, I\u2019ve run a similar test with a single six-sided die that has a&nbsp;<strong>16,67%<\/strong>&nbsp;chance of landing on any side.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-2\" data-shcb-language-name=\"PHP\" data-shcb-language-slug=\"php\"><div><code class=\"hljs language-php\">\nRollDie  &lt;-  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function<\/span><span class=\"hljs-params\">(iterations)<\/span>\n<\/span>{\n  <span class=\"hljs-comment\"># Creates  a  vector  with  the  possible  values  of  the  die<\/span>\n  <span class=\"hljs-keyword\">die<\/span>  =  <span class=\"hljs-number\">1<\/span>:<span class=\"hljs-number\">6<\/span>\n  result  =  <span class=\"hljs-number\">0<\/span>\n\n  <span class=\"hljs-comment\"># Alocates  the  die  roll  results<\/span>\n  result  =  sample(<span class=\"hljs-keyword\">die<\/span>,iterations,replace=T)\n\n  <span class=\"hljs-comment\"># Sum  up  every  instace  where  the  die  landed  on  6<\/span>\n  result  =  sum(result  ==  <span class=\"hljs-number\">6<\/span>)\n\n\u200b\n  <span class=\"hljs-comment\"># Turns  the  value  in  a  percentage  of  the  die  rolls<\/span>\n  result  =  (result\/iterations)  *  <span class=\"hljs-number\">100<\/span>\n\n  <span class=\"hljs-keyword\">return<\/span>(result)\n}\n\n<span class=\"hljs-comment\"># Initiates  variables<\/span>\nresult_vector  =  <span class=\"hljs-number\">0<\/span>\ntime_vector  =  <span class=\"hljs-number\">0<\/span>\ncontrol  =  <span class=\"hljs-number\">0<\/span>\n\n<span class=\"hljs-comment\"># Controls  the  interaction  quantity<\/span>\niterations  =  <span class=\"hljs-number\">100<\/span>\n\n<span class=\"hljs-comment\"># Alocates  the  percentual  of  \"6\"  results  in  a  100  size  vector  and  the  execution  time  in  another<\/span>\n<span class=\"hljs-keyword\">while<\/span>(control  !=  <span class=\"hljs-number\">100<\/span>)\n{\n  start_time  =  Sys.time()\n  result_vector  =  append(result_vector,  RollDie(iterations))  \n  finish_time  =  Sys.time()\n\n\u200b\n  time  =  finish_time  -  start_time\n  time_vector  =  append(time_vector,  time)  \n\n  control  =  control  +  <span class=\"hljs-number\">1<\/span>\n}\n\n<span class=\"hljs-comment\"># Shows  the  percentual  of  \"6\"<\/span>\nresult_vector\n\n<span class=\"hljs-comment\"># Shows  the  execution  times<\/span>\ntime_vector\n\n<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-2\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">PHP<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">php<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Changing the values of the iterations and compiling the results , I\u2019ve got the following table:<\/p>\n\n\n\n\n<table id=\"tablepress-12-no-2\" class=\"tablepress tablepress-id-12\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Iterations<\/th><th class=\"column-2\">Min result<\/th><th class=\"column-3\">Max result<\/th><th class=\"column-4\">Expected result<\/th><th class=\"column-5\">Average result<\/th><th class=\"column-6\">Average result - Expected result<\/th><th class=\"column-7\">Result's median<\/th><th class=\"column-8\">Result's median - Expected<\/th><th class=\"column-9\">result | Result's   Standard deviation<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">33.00000<\/td><td class=\"column-3\">67.00000<\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.02000 <\/td><td class=\"column-6\">0.02000 <\/td><td class=\"column-7\">50.00000 <\/td><td class=\"column-8\">0.00000 <\/td><td class=\"column-9\">5.09368 <\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">43.60000<\/td><td class=\"column-3\">56.20000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99440 <\/td><td class=\"column-6\">0.00560 <\/td><td class=\"column-7\">50.00000 <\/td><td class=\"column-8\">0.00000 <\/td><td class=\"column-9\">1.59105 <\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">48.35000<\/td><td class=\"column-3\">51.78000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.01263 <\/td><td class=\"column-6\">0.01263 <\/td><td class=\"column-7\">50.02000 <\/td><td class=\"column-8\">0.02000 <\/td><td class=\"column-9\">0.51001 <\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">49.58000<\/td><td class=\"column-3\">51.78000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99110 <\/td><td class=\"column-6\">0.00890 <\/td><td class=\"column-7\">49.99350 <\/td><td class=\"column-8\">0.00650 <\/td><td class=\"column-9\">0.15805 <\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">49.85170<\/td><td class=\"column-3\">50.15090 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99883 <\/td><td class=\"column-6\">0.00117 <\/td><td class=\"column-7\">49.99785 <\/td><td class=\"column-8\">0.00215 <\/td><td class=\"column-9\">0.04811 <\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">49.95433 <\/td><td class=\"column-3\">50.05807 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.00013 <\/td><td class=\"column-6\">0.00013 <\/td><td class=\"column-7\">50.00010 <\/td><td class=\"column-8\">0.00010 <\/td><td class=\"column-9\">0.01564 <\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">49.98435 <\/td><td class=\"column-3\">50.01637 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.00004 <\/td><td class=\"column-6\">0.00004 <\/td><td class=\"column-7\">49.99989 <\/td><td class=\"column-8\">0.00011 <\/td><td class=\"column-9\">0.00516 <\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">49.98890<\/td><td class=\"column-3\">50.01195 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99981 <\/td><td class=\"column-6\">0.00019 <\/td><td class=\"column-7\">49.99987 <\/td><td class=\"column-8\">0.00013 <\/td><td class=\"column-9\">0.00345 <\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-12-no-2 from cache -->\n\n\n\n<p>We can see that in this case, the iteration values are the same as for the instance of the coin toss, where a good value could be something between&nbsp;<strong>10M<\/strong>&nbsp;and&nbsp;100M&nbsp;if you need to have an error in the&nbsp;third decimal, between&nbsp;100k&nbsp;and&nbsp;1M&nbsp;for an error in the&nbsp;second decimal&nbsp;and between&nbsp;1k&nbsp;and&nbsp;10k&nbsp;for an error in the&nbsp;<strong>first decimal<\/strong>.<\/p>\n\n\n\n<p>This test result shows that, either the complexity of the problem has no influence on the number of interactions or that both problems (coin toss and single die roll) have similar complexity levels.<\/p>\n\n\n\n<p>Analyzing the execution times for both problems, it\u2019s possible to see that they took about the same time. This also corroborates with the hypothesis that they have similar complexity levels.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\" id=\"two-dice\">TWO DICE<\/h3>\n\n\n\n<p>To test the hypothesis that the complexity of the above problems were too close, and this was the reason for the interaction values to be close, I\u2019ve decided to double the complexity of the die roll problem by rolling&nbsp;<strong>two<\/strong>&nbsp;dice instead of only&nbsp;<strong>one<\/strong>&nbsp;(it\u2019s important to note that doubling the quantity of functions doesn\u2019t always mean that the complexity order will double as well, as it depends on the&nbsp;Big-O Notation). The highest probability value for two dice is&nbsp;7, with&nbsp;a <strong>16,67%<\/strong>&nbsp;chance of occurrence.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-3\" data-shcb-language-name=\"PHP\" data-shcb-language-slug=\"php\"><div><code class=\"hljs language-php\">RollsTwoDice &lt;- <span class=\"hljs-function\"><span class=\"hljs-keyword\">function<\/span><span class=\"hljs-params\">(iterations)<\/span>\n<\/span>{\n  <span class=\"hljs-comment\"># Creates a vector with the possible values of the die<\/span>\n  <span class=\"hljs-keyword\">die<\/span> = <span class=\"hljs-number\">1<\/span>:<span class=\"hljs-number\">6<\/span>\n  result = <span class=\"hljs-number\">0<\/span>\n\t\n  <span class=\"hljs-comment\"># Alocates the die roll results<\/span>\n  first_roll = sample(<span class=\"hljs-keyword\">die<\/span>,iterations,replace=T)\n  second_roll = sample(<span class=\"hljs-keyword\">die<\/span>,iterations,replace=T)\n\n  <span class=\"hljs-comment\"># Sum the vector values position-wise<\/span>\n  result = first_roll + second_roll\n\n  <span class=\"hljs-comment\"># Sum up every instace where the dice landed on 7<\/span>\n  result = sum(result == <span class=\"hljs-number\">7<\/span>)\n\n  <span class=\"hljs-comment\"># Turns the value in a percentage of the dice rolls<\/span>\n  result = (result\/iterations) * <span class=\"hljs-number\">100<\/span>\n\n  <span class=\"hljs-keyword\">return<\/span>(result)\n}\n\n<span class=\"hljs-comment\"># Initiates variables<\/span>\nresult_vector = <span class=\"hljs-number\">0<\/span>\ntime_vector = <span class=\"hljs-number\">0<\/span>\ncontrol = <span class=\"hljs-number\">0<\/span>\n\n<span class=\"hljs-comment\"># Controls the interaction quantity<\/span>\niterations = <span class=\"hljs-number\">100<\/span>\n\n<span class=\"hljs-comment\"># Alocates the percentual of \"7\" results in a 100 size vector and the execution time in another<\/span>\n<span class=\"hljs-keyword\">while<\/span>(control != <span class=\"hljs-number\">100<\/span>)\n{\n  start_time = Sys.time()\n  result_vector = append(result_vector, RollsTwoDice(iterations)) \n  finish_time = Sys.time()\n\n  time = finish_time - start_time\n  time_vector = append(time_vector, time) \n\n  control = control + <span class=\"hljs-number\">1<\/span>\n}\n\n<span class=\"hljs-comment\"># Shows the percentual of \"7\"<\/span>\nresult_vector\n\n<span class=\"hljs-comment\"># Shows the execution times<\/span>\ntime_vector\n<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-3\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">PHP<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">php<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Changing the values of the iterations and compiling the results, I\u2019ve got the following table:<\/p>\n\n\n\n<table id=\"tablepress-13\" class=\"tablepress tablepress-id-13\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Iterations<\/th><th class=\"column-2\">Min result<\/th><th class=\"column-3\">Max result<\/th><th class=\"column-4\">Expected result<\/th><th class=\"column-5\">Average result<\/th><th class=\"column-6\">Average result - Expected result<\/th><th class=\"column-7\">Result's median<\/th><th class=\"column-8\">Result's median - Expected<\/th><th class=\"column-9\">result | Result's   Standard deviation<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">6.00000<\/td><td class=\"column-3\">28.00000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.58100<\/td><td class=\"column-6\">-0.08567<\/td><td class=\"column-7\">16.00000<\/td><td class=\"column-8\">-0.66667<\/td><td class=\"column-9\">3.64372<\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">13.20000<\/td><td class=\"column-3\">20.40000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.68500<\/td><td class=\"column-6\">0.01833<\/td><td class=\"column-7\">16.60000<\/td><td class=\"column-8\">-0.06667<\/td><td class=\"column-9\">1.16949<\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">15.60000<\/td><td class=\"column-3\">17.94000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.65962<\/td><td class=\"column-6\">-0.00705<\/td><td class=\"column-7\">16.67000<\/td><td class=\"column-8\">0.00333<\/td><td class=\"column-9\">0.38072<\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">16.22200<\/td><td class=\"column-3\">17.06200<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66109<\/td><td class=\"column-6\">-0.00557<\/td><td class=\"column-7\">16.66500<\/td><td class=\"column-8\">-0.00167<\/td><td class=\"column-9\">0.11356<\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">16.54960<\/td><td class=\"column-3\">16.54960<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66616<\/td><td class=\"column-6\">-0.00050<\/td><td class=\"column-7\">16.66790<\/td><td class=\"column-8\">0.00123<\/td><td class=\"column-9\">0.03650<\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">16.63294<\/td><td class=\"column-3\">16.70266<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66607<\/td><td class=\"column-6\">-0.00060<\/td><td class=\"column-7\">16.66577<\/td><td class=\"column-8\">-0.00090<\/td><td class=\"column-9\">0.01220<\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">16.65592<\/td><td class=\"column-3\">16.67948<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66670<\/td><td class=\"column-6\">0.00004<\/td><td class=\"column-7\">16.66679<\/td><td class=\"column-8\">0.00012<\/td><td class=\"column-9\">0.00372<\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">16.65787<\/td><td class=\"column-3\">16.67476<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66671<\/td><td class=\"column-6\">0.00004<\/td><td class=\"column-7\">16.66671<\/td><td class=\"column-8\">0.00004<\/td><td class=\"column-9\">0.00267<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-13 from cache -->\n\n\n\n<p>Again we find the same interaction quantity for each error level. In the case of this problem it\u2019s possible to identify that it was more complex since the execution for 200M took on average&nbsp;<strong>7.47 seconds longer<\/strong>&nbsp;when compared to the single die roll.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\" id=\"five-dice\">FIVE DICE<\/h3>\n\n\n\n<p>The inference that I\u2019ve built until this point is that the complexity of the problem influences very little in the iteration quantities, but to be sure of that, I ran one last test with 5 dice. The highest probability when rolling five dice is the values of&nbsp;<strong>17<\/strong>&nbsp;and&nbsp;<strong>18<\/strong>, with&nbsp;<strong>10.03%<\/strong>&nbsp;probability each.<\/p>\n\n\n\n<p>Since this problem is a lot more complex than the others I\u2019ve decided to run only 10 times each instead of 100.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-4\" data-shcb-language-name=\"PHP\" data-shcb-language-slug=\"php\"><div><code class=\"hljs language-php\">RollsFiveDice &lt;- <span class=\"hljs-function\"><span class=\"hljs-keyword\">function<\/span><span class=\"hljs-params\">(iterations)<\/span>\n<\/span>{\n  <span class=\"hljs-comment\"># Creates a vector with the possible values of the die<\/span>\n  dado = <span class=\"hljs-number\">1<\/span>:<span class=\"hljs-number\">6<\/span>\n  result = <span class=\"hljs-number\">0<\/span>\n\t\n  <span class=\"hljs-comment\"># Alocates the die roll results<\/span>\n  first_roll = sample(dado,iterations,replace=T)\n  second_roll = sample(dado,iterations,replace=T)\n  terceira_rolagem = sample(dado,iterations,replace=T)\n  quarta_rolagem = sample(dado,iterations,replace=T)\n  quinta_rolagem = sample(dado,iterations,replace=T)\n\n  <span class=\"hljs-comment\"># Sum the vector values position-wise<\/span>\n  result = first_roll + second_roll + terceira_rolagem + quarta_rolagem + quinta_rolagem\n\n  <span class=\"hljs-comment\"># Sum up every instace where the dice landed on 18<\/span>\n  result = sum(result == <span class=\"hljs-number\">18<\/span>)\n\n  <span class=\"hljs-comment\"># Turns the value in a percentage of the dice rolls<\/span>\n  result = (result\/iterations) * <span class=\"hljs-number\">100<\/span>\n\t\n  <span class=\"hljs-keyword\">return<\/span>(result)\n}\n\n<span class=\"hljs-comment\"># Initiates variables<\/span>\nresult_vector = <span class=\"hljs-number\">0<\/span>\ntime_vector = <span class=\"hljs-number\">0<\/span>\ncontrol = <span class=\"hljs-number\">0<\/span>\n\n<span class=\"hljs-comment\"># Controls the interaction quantity<\/span>\niterations = <span class=\"hljs-number\">10<\/span>\n\n<span class=\"hljs-comment\"># Alocates the percentual of \"18\" results in a 100 size vector and the execution time in another<\/span>\n<span class=\"hljs-keyword\">while<\/span>(control != <span class=\"hljs-number\">100<\/span>)\n{\n  start_time = Sys.time()\n  result_vector = append(result_vector, RollsFiveDice(iterations)) \n  finish_time = Sys.time()\n\n  time = finish_time - start_time\n  time_vector = append(time_vector, time) \n\n  control = control + <span class=\"hljs-number\">1<\/span>\n}\n\n<span class=\"hljs-comment\"># Shows the percentual of \"18\"<\/span>\nresult_vector\n\n<span class=\"hljs-comment\"># Shows the execution times<\/span>\ntime_vector\n<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-4\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">PHP<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">php<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Changing the values of the iterations and compiling the results, I\u2019ve got the following table:<\/p>\n\n\n\n<table id=\"tablepress-14\" class=\"tablepress tablepress-id-14\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Iterations<\/th><th class=\"column-2\">Min result<\/th><th class=\"column-3\">Max result<\/th><th class=\"column-4\">Expected result<\/th><th class=\"column-5\">Average result<\/th><th class=\"column-6\">Average result - Expected result<\/th><th class=\"column-7\">Result's median<\/th><th class=\"column-8\">Result's median - Expected result<\/th><th class=\"column-9\">Result's  Standard deviation<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">5.00000<\/td><td class=\"column-3\">31.00000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.37100<\/td><td class=\"column-6\">-0.29567<\/td><td class=\"column-7\">16.00000<\/td><td class=\"column-8\">-0.66667<\/td><td class=\"column-9\">3.77487<\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">13.40000<\/td><td class=\"column-3\">21.80000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.64710<\/td><td class=\"column-6\">-0.01957<\/td><td class=\"column-7\">16.60000<\/td><td class=\"column-8\">-0.06667<\/td><td class=\"column-9\">1.18550<\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">15.33000<\/td><td class=\"column-3\">17.77000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.68307<\/td><td class=\"column-6\">0.01640<\/td><td class=\"column-7\">16.68500<\/td><td class=\"column-8\">0.01833<\/td><td class=\"column-9\">0.38059<\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">16.23100<\/td><td class=\"column-3\">17.06600<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66546<\/td><td class=\"column-6\">-0.00120<\/td><td class=\"column-7\">16.66800<\/td><td class=\"column-8\">0.00133<\/td><td class=\"column-9\">0.11597<\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">16.54450<\/td><td class=\"column-3\">16.81170<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66657<\/td><td class=\"column-6\">-0.00010<\/td><td class=\"column-7\">16.66860<\/td><td class=\"column-8\">0.00193<\/td><td class=\"column-9\">0.03798<\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">16.62888<\/td><td class=\"column-3\">16.70282<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66683<\/td><td class=\"column-6\"> 0.00016<\/td><td class=\"column-7\">16.66705<\/td><td class=\"column-8\">0.00038<\/td><td class=\"column-9\">0.01155<\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">16.65408<\/td><td class=\"column-3\">16.67899<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66669<\/td><td class=\"column-6\">0.00002<\/td><td class=\"column-7\">16.66673<\/td><td class=\"column-8\">0.00007<\/td><td class=\"column-9\">0.00382<\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">16.65881<\/td><td class=\"column-3\">16.67455<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66675<\/td><td class=\"column-6\">0.00009<\/td><td class=\"column-7\">16.66682<\/td><td class=\"column-8\">0.00015<\/td><td class=\"column-9\">0.00258<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-14 from cache -->\n\n\n\n<p>Once again we can see that the values for the iterations are the same as above. It\u2019s possible to notice that this problem is clearly more complex, as it took&nbsp;<strong>35 seconds longer<\/strong>&nbsp;when compared to the roll of a single die.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"conclusion\">CONCLUSION<\/h2>\n\n\n\n<p>After running those tests, it\u2019s possible to conclude that for the use on project management, a good iteration value would be somewhere between&nbsp;<strong>1k<\/strong>&nbsp;and&nbsp;<strong>100M<\/strong>, depending on the error level as shown below:<\/p>\n\n\n\n<ul><li>Error in the first decimal: 1k to 10k<\/li><li>Error in the second decimal: 100k to 1M<\/li><li>Error in the third decimal: 10M to 100M<\/li><\/ul>\n\n\n\n<p>The value that I\u2019ve been using is 3M, for stakeholder reports. However, when I\u2019m running the method for my own analysis, I use a lower value, somewhere between 250k and 750k.<\/p>\n\n\n\n<p>How about you? Have you tried to run Monte Carlo Simulations? How many iterations are you using? Tell us in the comment section below or on Twitter @plataformatec.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>One of the reasons to use any kind of project management methodology is to reduce costs. A delay in a single week of a project creates two different cost types: The first is the cost of the team, since they will need to work another week. The second is the Cost of Delay, which is &#8230; <a class=\"read-more-link\" href=\"http:\/\/blog.plataformatec.com.br\/2019\/10\/monte-carlo-in-practice-finding-the-ideal-iteration-value\/\">\u00bb<\/a><\/p>\n","protected":false},"author":69,"featured_media":9413,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"ngg_post_thumbnail":0,"footnotes":""},"categories":[1],"tags":[123],"aioseo_notices":[],"jetpack_sharing_enabled":true,"jetpack_featured_media_url":"http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/10\/monte-carlo-in-practice-finding-the-ideal-iteration-value.gif","_links":{"self":[{"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/9410"}],"collection":[{"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/users\/69"}],"replies":[{"embeddable":true,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/comments?post=9410"}],"version-history":[{"count":24,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/9410\/revisions"}],"predecessor-version":[{"id":9551,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/9410\/revisions\/9551"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/media\/9413"}],"wp:attachment":[{"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/media?parent=9410"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/categories?post=9410"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/tags?post=9410"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}
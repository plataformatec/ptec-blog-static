{"id":833,"date":"2010-03-19T09:16:16","date_gmt":"2010-03-19T12:16:16","guid":{"rendered":"http:\/\/blog.plataformatec.com.br\/?p=833"},"modified":"2010-04-22T14:55:56","modified_gmt":"2010-04-22T17:55:56","slug":"mostre-seus-models-baby","status":"publish","type":"post","link":"https:\/\/blog.plataformatec.com.br\/2010\/03\/mostre-seus-models-baby\/","title":{"rendered":"Mostre seus models baby!"},"content":{"rendered":"<p>Ultimamente temos trabalhado em alguns projetos que necessitaram de v\u00e1rios CRUDs na administra\u00e7\u00e3o como p\u00e1ginas mostrando listas de atributos. E com passar do tempo, est\u00e1vamos ficando entediados de tanto copiar e colar c\u00f3digo como este para cada atributo em nossas p\u00e1ginas:<\/p>\n<pre lang=\"ruby\">\r\n<p>\r\n  <strong class=\"label\">Name<\/strong><br \/>\r\n  <%= @person.name %>\r\n<\/p>\r\n<\/pre>\n<p>N\u00f3s j\u00e1 tinhamos criado um helper para fazer o trabalho para n\u00f3s, mas copiar este helper de um projeto para outro n\u00e3o \u00e9 DRY. Ent\u00e3o decidimos criar uma nova gem, chamada <a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a>.<\/p>\n<p><a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> \u00e9 uma DSL para auxili\u00e1-lo a mostrar uma lista de atributos, usando I18n, perfeito para p\u00e1ginas de visualiza\u00e7\u00e3o em interfaces CRUDs. Ele permite que voc\u00ea substitua duplica\u00e7\u00e3o de c\u00f3digo\/html em suas views usando uma sintaxe mais atraente. Vejamos o que podemos fazer!<\/p>\n<h3>Atributos<\/h3>\n<p>Vamos imaginar que temos um model Person, que possui os atributos first_name, last_name, age, photo, e confirmed. As linhas abaixo criam uma lista de valores para um registro espec\u00edfico:<\/p>\n<pre lang=\"ruby\">\r\n<% show_for @person do |p| %>\r\n  <%= p.attribute :first_name %>\r\n  <%= p.attribute :last_name %>\r\n  <%= p.attribute :confirmed? %>\r\n  <%= p.attribute :created_at, :format => :short %>\r\n  <%= p.attribute :age, :if_blank => \"No age\" %>\r\n\r\n  <% p.attribute :photo do %>\r\n    <%= image_tag(@person.photo_url) %>\r\n  <% end %>\r\n<% end %>\r\n<\/pre>\n<p>E este \u00e9 o c\u00f3digo HTML que voc\u00ea tem como resultado:<\/p>\n<pre lang=\"html\">\r\n<div class=\"show_for person\" id=\"person_1\">\r\n  <p class=\"wrapper person_first_name\"><strong class=\"label\">First name<\/strong><br \/>Carlos<\/p>\r\n  <p class=\"wrapper person_last_name\"><strong class=\"label\">Last name<\/strong><br \/>Antonio<\/p>\r\n  <p class=\"wrapper person_confirmed\"><strong class=\"label\">Confirmed?<\/strong><br \/>Yes<\/p>\r\n  <p class=\"wrapper person_created_at\"><strong class=\"label\">Created at<\/strong><br \/>08 Mar 11:30<\/p>\r\n  <p class=\"wrapper person_age\"><strong class=\"label\">Age<\/strong><br \/>24<\/p>\r\n  <p class=\"wrapper person_photo\"><strong class=\"label\">Photo<\/strong><br \/>\r\n    <img decoding=\"async\" alt=\"Rails\" src=\"\/images\/rails.png?1268047643\" \/>\r\n  <\/p>\r\n<\/div>\r\n<\/pre>\n<p>Como se pode ver, voc\u00ea ter\u00e1 uma marca\u00e7\u00e3o HTML padr\u00e3o, com classes e ids para ajud\u00e1-lo no design com CSS. E caso tenha notado, estamos usando op\u00e7\u00f5es extras em alguns atributos, vamos dar uma olhada em algumas delas:<\/p>\n<ul>\n<li><code>:format<\/code> permite que voc\u00ea defina um formato a ser usando com I18n, somente para atributos date\/time, como voc\u00ea usaria com o helper <code>l<\/code>.<\/li>\n<li><code>:if_blank<\/code> define o que ser\u00e1 mostrado caso o atributo esteja em branco. Pode ter um valor padr\u00e3o via I18n.<\/li>\n<li><code>do...end<\/code>: usando blocos voc\u00ea mesmo pode manusear o conte\u00fado para o atributo espec\u00edfico, como fizemos no exemplo para o atributo <code>photo<\/code>.<\/li>\n<\/ul>\n<p>Atributos booleanos, como nosso <code>:confirmed<\/code>, tamb\u00e9m possuem um valor padr\u00e3o para <code>true<\/code> e <code>false<\/code>, e podem ser configurados atrav\u00e9s de I18n. Se voc\u00ea deseja mostrar &#8220;Sim&#8221; e &#8220;N\u00e3o&#8221; no lugar de &#8220;Yes&#8221; e &#8220;No&#8221; respectivamente, s\u00f3 precisa mudar seu arquivo I18n. Voc\u00ea tamb\u00e9m pode passar a op\u00e7\u00e3o <code>:escape<\/code> para n\u00e3o escapar o conte\u00fado (<code>true<\/code> por padr\u00e3o).<\/p>\n<h3>Associa\u00e7\u00f5es<\/h3>\n<p><a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> tamb\u00e9m funciona com associa\u00e7\u00f5es. Por exemplo, podemos adicionar que nosso Person agora pertence a um model City com um atributo nome, e que tamb\u00e9m possui e pertence a muitas Tags. Para gerenciar o primeiro, podemos fazer:<\/p>\n<pre lang=\"ruby\">\r\n<%= p.association :city %>\r\n<\/pre>\n<p><a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> ir\u00e1 adivinhar o atributo correto para mostrar procurando todas as possibilidades configuradas em <code>ShowFor.association_methods<\/code> e neste caso escolhendo :name. Mas \u00e9 claro, voc\u00ea pode modificar isso se precisar:<\/p>\n<pre lang=\"ruby\">\r\n<%= p.association :city, :using => :full_name %>\r\n<%= p.attribute :full_name, :in => :city %>\r\n<\/pre>\n<p>Ambas as possibilidades acima ter\u00e3o a mesma sa\u00edda, apenas escolha a que voc\u00ea mais gostar.<\/p>\n<p>Manusear cole\u00e7\u00f5es \u00e9 t\u00e3o f\u00e1cil quanto associa\u00e7\u00f5es belongs_to. Voc\u00ea simplesmente passa a associa\u00e7\u00e3o para <a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> e ele ir\u00e1 saber se \u00e9 uma cole\u00e7\u00e3o ou n\u00e3o, gerando uma lista de elementos usando tags <code>ul<\/code> e <code>li<\/code>.<\/p>\n<pre lang=\"ruby\">\r\n<%= p.association :tags %>\r\n<\/pre>\n<p>Entretando, se voc\u00ea quiser renderizar a cole\u00e7\u00e3o inline, pode usar as op\u00e7\u00f5es :to_sentence e :join:<\/p>\n<pre lang=\"ruby\">\r\n<%= p.association :tags, :to_sentence => true %>\r\n<%= p.association :tags, :join => ',' %>\r\n<\/pre>\n<p>Tamb\u00e9m \u00e9 poss\u00edvel passar um bloco para a cole\u00e7\u00e3o. O <a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> criar\u00e1 a tag wrapper (<code>ul<\/code> por padr\u00e3o nesse caso) e retornar\u00e1 cada elemento da cole\u00e7\u00e3o para voc\u00ea gerenci\u00e1-lo:<\/p>\n<pre lang=\"ruby\">\r\n<% a.association :tags do |tag| %>\r\n  <li><%= link_to tag.name, tag %><\/li>\r\n<% end %>\r\n<\/pre>\n<h3>Labels<\/h3>\n<p>Voc\u00ea deve ter percebido que o <a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> possui um label padr\u00e3o usando a tag <code>strong<\/code>. Ele tamb\u00e9m exp\u00f5e a voc\u00ea o m\u00e9todo <code>label<\/code> como um helper, para que possa us\u00e1-lo quando desejar:<\/p>\n<pre lang=\"ruby\">\r\n  <%= p.label :first_name %>\r\n  <%= p.label :age, :id => 'person_age' %>\r\n\r\n  <strong class=\"label\">First name<\/strong>\r\n  <strong class=\"label\" id=\"person_age\">Age<\/strong>\r\n<\/pre>\n<h3>Instala\u00e7\u00e3o<\/h3>\n<p>O <a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a>, em sua vers\u00e3o 0.2.0, j\u00e1 \u00e9 compat\u00edvel com o Rails 3. Voc\u00ea pode seguir as instru\u00e7\u00f5es no <a href=\"http:\/\/github.com\/plataformatec\/show_for\/blob\/master\/README.rdoc\">README<\/a> para instal\u00e1-lo.<\/p>\n<p>Se voc\u00ea est\u00e1 usando o Rails 2.3.x, pode dar uma olhada no <a href=\"http:\/\/github.com\/plataformatec\/show_for\/tree\/v0.1\">branch 0.1<\/a>, e seguir as instru\u00e7\u00f5es no <a href=\"http:\/\/github.com\/plataformatec\/show_for\/blob\/v0.1\/README.rdoc\">README<\/a> deste branch para utiliz\u00e1-lo.<\/p>\n<p>E ap\u00f3s a instala\u00e7\u00e3o, n\u00e3o se esque\u00e7a de executar o generator e dar uma olhada no initializer gerado, que permite que voc\u00ea configure v\u00e1rias partes do <a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a>.<\/p>\n<pre lang=\"ruby\">\r\nscript\/generate show_for_install\r\n<\/pre>\n<h3>Fechando<\/h3>\n<p><a href=\"http:\/\/github.com\/plataformatec\/show_for\" title=\"ShowFor - Wrap your objects with a helper to easily show them\">ShowFor<\/a> ajuda voc\u00ea a mostrar os atributos de seus objetos facilmente com uma marca\u00e7\u00e3o html padr\u00e3o, e pode ser totalmente configurado para atender sua necessidade. Ele tem nos ajudado em todos os projetos, e esperamos que ele possa ajud\u00e1-lo tamb\u00e9m. Se voc\u00ea tiver alguma d\u00favida, por favor d\u00ea uma olhada no <a href=\"http:\/\/github.com\/plataformatec\/show_for\/blob\/master\/README.rdoc\">README<\/a>, existem muitos exemplos e documenta\u00e7\u00e3o l\u00e1.<\/p>\n<p>E voc\u00ea? Possui algum helper que usa todos os dias e que poderia ser transformado em um plugin\/gem? N\u00e3o hesite em fazer isto, ficaremos contentes em ver seu trabalho!<\/p>\n<p>Divirta-se!<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Ultimamente temos trabalhado em alguns projetos que necessitaram de v\u00e1rios CRUDs na administra\u00e7\u00e3o como p\u00e1ginas mostrando listas de atributos. E com passar do tempo, est\u00e1vamos ficando entediados de tanto copiar e colar c\u00f3digo como este para cada atributo em nossas p\u00e1ginas: Name N\u00f3s j\u00e1 tinhamos criado um helper para fazer o trabalho para n\u00f3s, mas &#8230; <a class=\"read-more-link\" href=\"https:\/\/blog.plataformatec.com.br\/2010\/03\/mostre-seus-models-baby\/\">\u00bb<\/a><\/p>\n","protected":false},"author":7,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"ngg_post_thumbnail":0,"footnotes":""},"categories":[3],"tags":[],"aioseo_notices":[],"jetpack_sharing_enabled":true,"jetpack_featured_media_url":"","_links":{"self":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/833"}],"collection":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/users\/7"}],"replies":[{"embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/comments?post=833"}],"version-history":[{"count":14,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/833\/revisions"}],"predecessor-version":[{"id":908,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/833\/revisions\/908"}],"wp:attachment":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/media?parent=833"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/categories?post=833"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/tags?post=833"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}
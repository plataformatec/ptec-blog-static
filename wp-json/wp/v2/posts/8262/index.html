{"id":8262,"date":"2018-12-18T13:44:39","date_gmt":"2018-12-18T15:44:39","guid":{"rendered":"http:\/\/blog.plataformatec.com.br\/?p=8262"},"modified":"2019-10-28T11:38:44","modified_gmt":"2019-10-28T14:38:44","slug":"monte-carlo-na-pratica-encontrando-o-valor-de-iteracoes-ideal","status":"publish","type":"post","link":"https:\/\/blog.plataformatec.com.br\/2018\/12\/monte-carlo-na-pratica-encontrando-o-valor-de-iteracoes-ideal\/","title":{"rendered":"Monte Carlo na Pr\u00e1tica: Encontrando o valor de itera\u00e7\u00f5es ideal"},"content":{"rendered":"<p>Um dos maiores motivos pelo qual qualquer metodologia de gerenciamento de projetos existe, \u00e9 trazer redu\u00e7\u00e3o de custos.<\/p>\n<p>O atraso de uma semana em um projeto, gera dois custos diferentes:<\/p>\n<ul>\n<li>O primeiro custo \u00e9 o custo das pessoas presentes no time do projeto, por terem que trabalhar por mais uma semana.<\/li>\n<li>J\u00e1 o segundo, trata-se do custo de atraso (normalmente chamado de <em>cost of delay<\/em>) que por sua vez \u00e9 a receita que deixa-se de receber pelo atraso, por exemplo: supondo que um novo produto tenha uma receita di\u00e1ria de 100 reais, o custo de atraso seria de 700 reais (100 reais x 7 dias), aqui no blog temos um <a href=\"http:\/\/blog.plataformatec.com.br\/2016\/11\/calculating-cost-of-delay-for-software-projects\/\" target=\"_blank\" rel=\"noopener noreferrer\">post muito interessante sobre o assunto<\/a>.<\/li>\n<\/ul>\n<p>Como esses custos podem ser altos, \u00e9 preciso utilizar ferramentas que possam dar visibilidade para as datas de entrega. Uma das formas encontradas para dar visibilidade a estes potenciais problemas, foi atrav\u00e9s da ado\u00e7\u00e3o do Diagrama de Gantt, para gerenciamento de projetos, nele \u00e9 poss\u00edvel identificar os pontos mais delicados do projeto (os caminhos cr\u00edticos) em que deve-se dar maior esfor\u00e7o para que n\u00e3o atrasem, visto que ao atrasar nesses pontos o projeto inteiro tamb\u00e9m ir\u00e1 atrasar.<\/p>\n<p>Embora essa ferramenta seja \u00f3tima para alguns tipos de projetos (normalmente onde existe um grau de incerteza baixo), ela n\u00e3o \u00e9 a ideal para projetos com previsibilidade baixa devido a <a href=\"https:\/\/pt.wikipedia.org\/wiki\/Vari%C3%A2ncia\" target=\"_blank\" rel=\"noopener noreferrer\">vari\u00e2ncia<\/a>\u00a0de entregas, como ocorre em projetos que lidam com o campo do conhecimento (redigir um livro ou desenvolver software, como exemplos).<\/p>\n<p>Aqui na Plataformatec temos sempre feito o m\u00e1ximo para que todas as nossas previs\u00f5es de entregas sejam embasadas em dados e sigam m\u00e9todos cient\u00edficos comprovados. Os dois m\u00e9todos que mais utilizamos s\u00e3o:<\/p>\n<ul>\n<li>Progress\u00e3o linear<\/li>\n<li>Simula\u00e7\u00e3o de Monte Carlo<\/li>\n<\/ul>\n<h2>PROGRESS\u00c3O LINEAR<\/h2>\n<p>Na progress\u00e3o linear, fazemos uma an\u00e1lise dos dados de itens de trabalho entregues durante algum per\u00edodo (normalmente trabalhamos com periodicidade semanal) e atrav\u00e9s de uma an\u00e1lise destes valores elegemos quais s\u00e3o os melhores valores a serem alocados na progress\u00e3o. Por exemplo: supondo que tenhamos os valores de hist\u00f3rico de itens de trabalho entregues por semana (throughput), conforme o gr\u00e1fico abaixo:<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-8134 size-full\" src=\"http:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2018\/12\/tabela_de_tp.png\" alt=\"\" width=\"1554\" height=\"688\" srcset=\"https:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2018\/12\/tabela_de_tp.png 1554w, https:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2018\/12\/tabela_de_tp-300x133.png 300w, https:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2018\/12\/tabela_de_tp-768x340.png 768w, https:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2018\/12\/tabela_de_tp-1024x453.png 1024w\" sizes=\"(max-width: 1554px) 100vw, 1554px\" \/><\/p>\n<p>Um valor que faz sentido para a progress\u00e3o <strong>pessimista<\/strong> ser\u00e1 de que a cada semana iremos entregar <strong>1<\/strong> item de trabalho por semana, visto que tivemos 5 casos em que a entrega foi de <strong>1<\/strong> ou <strong>0<\/strong>, para a estimativa <strong>otimista<\/strong> podemos utilizar o valor <strong>3<\/strong> ou <strong>4<\/strong> ou at\u00e9 mesmo <strong>3,5<\/strong> visto que tivemos 4 casos em que o valor foi 3 ou mais, por fim para a progress\u00e3o <strong>prov\u00e1vel<\/strong> o melhor valor seria o de <strong>2<\/strong> visto que \u00e9 o valor da mediana do <em>dataset<\/em> e \u00e9 o valor que mais aparece (a moda).<\/p>\n<p>O maior problema da progress\u00e3o linear \u00e9 de que estamos informando os valores a serem utilizados para cada cen\u00e1rio, algo que pode ser perigoso caso a pessoa que est\u00e1 fazendo a progress\u00e3o n\u00e3o tenha um bom dom\u00ednio de an\u00e1lise de dados. Al\u00e9m disso, a progress\u00e3o linear tamb\u00e9m ignora a vari\u00e2ncia. Desta forma, em sistemas com uma vari\u00e2ncia de entrega muito elevada, a progress\u00e3o linear pode n\u00e3o fazer tanto sentido.<\/p>\n<h2>MONTE CARLO<\/h2>\n<p>Outra t\u00e9cnica que utilizamos chama-se <strong>Monte Carlo<\/strong>, para entender melhor como o m\u00e9todo funciona, bem como ter uma infer\u00eancia do que ele faz, recomendo <a href=\"http:\/\/blog.plataformatec.com.br\/2017\/06\/por-que-usamos-simulacoes-de-monte-carlo-para-gerenciar-projetos\/\" target=\"_blank\" rel=\"noopener noreferrer\">esse blogpost que \u00e9 bem completo<\/a>.<\/p>\n<p>Tenho utilizado o m\u00e9todo desde que entrei na Plataformatec com grande sucesso, por\u00e9m uma coisa sempre ficava na minha mente era: &#8220;Quantas itera\u00e7\u00f5es s\u00e3o necess\u00e1rias para que eu possa ter um bom grau de confiabilidade no m\u00e9todo?&#8221;. Para responder essa pergunta eu fiz muitas pesquisas em livros estat\u00edsticos e pela internet e n\u00e3o consegui encontrar nenhum tipo de informa\u00e7\u00e3o que me auxiliasse.<\/p>\n<p>Dessa forma resolvi fazer um estudo desse assunto. O objetivo do Monte Carlo \u00e9 de inferir a probabilidade de algum evento, &#8220;for\u00e7ando&#8221; que o evento ocorra tantas vezes que o resultado me d\u00ea a probabilidade da ocorr\u00eancia do evento. Por exemplo, ao lan\u00e7ar uma moeda mil vezes se eu contar quantas vezes a moeda cai em &#8220;cara&#8221; e dividir esse valor pelas mil vezes que a moeda foi lan\u00e7ada, obterei uma infer\u00eancia da probabilidade da moeda cair em &#8220;cara&#8221;.<\/p>\n<p>Para conseguir saber a qualidade do m\u00e9todo eu realizei testes nos quais eu j\u00e1 sabia o resultado esperado, e fui fazendo com que o problema fosse cada vez mais complexo, de forma a ver se existe alguma rela\u00e7\u00e3o entre a dificuldade do problema e a quantidade de itera\u00e7\u00f5es necess\u00e1rias para que o valor inferido pelo m\u00e9todo seja o mais pr\u00f3ximo poss\u00edvel do valor calculado.<\/p>\n<p>O objetivo \u00e9 verificar quantas itera\u00e7\u00f5es s\u00e3o necess\u00e1rias para que o erro entre o valor inferido pelo m\u00e9todo e o valor calculado seja m\u00ednimo (para previs\u00f5es de probabilidade de entrega um erro a partir da segunda ou terceira casa decimal \u00e9 bem aceit\u00e1vel). Gostaria de ressaltar que esse <em>blogpost<\/em> n\u00e3o \u00e9 um estudo cient\u00edfico acerca do assunto, e seu objetivo \u00e9 entender atrav\u00e9s de infer\u00eancia qual \u00e9 um valor de itera\u00e7\u00f5es bom para ser utilizado em predi\u00e7\u00f5es para projetos.<\/p>\n<h2>OS TESTES<\/h2>\n<p>Os testes foram todos realizado utilizando a linguagem de programa\u00e7\u00e3o <strong>R<\/strong>, que pode ser baixado neste <a href=\"https:\/\/www.r-project.org\/\" target=\"_blank\" rel=\"noopener noreferrer\">link<\/a>. Caso prefira utilizar um IDE, recomendo o <a href=\"https:\/\/www.rstudio.com\/\" target=\"_blank\" rel=\"noopener noreferrer\">RStudio<\/a>.<\/p>\n<p>Em todos os testes eu rodei o sistema por 100 vezes utilizando as seguintes quantidades de itera\u00e7\u00f5es: <strong>100<\/strong> (cem), <strong>1000<\/strong> (mil), <strong>10000<\/strong> (dez mil), <strong>100000<\/strong> (cem mil), <strong>1000000<\/strong> (um milh\u00e3o), <strong>10000000<\/strong> (dez milh\u00f5es), <strong>100000000<\/strong> (cem milh\u00f5es) e <strong>200000000<\/strong> (duzentos milh\u00f5es). Os resultados s\u00e3o os consolidados dessas 100 &#8220;rodadas&#8221;, em cada itera\u00e7\u00e3o.<\/p>\n<h3>A MOEDA<\/h3>\n<p>O primeiro teste que fiz foi em cima de um lan\u00e7amento de moeda. Uma moeda tem <strong>50%<\/strong> de chance de cair em qualquer um de seus lados e este \u00e9 o valor que queremos que seja inferido pelo Monte Carlo. Para isso utilizei o seguinte c\u00f3digo em R:<\/p>\n<pre><code class=\"R\">LancaMoeda &lt;- function(iteracoes)\n{\n# Cria o vetor com os valores poss\u00edveis para a moeda 1 = Cara e 0 = Coroa\nmoeda = c(0,1)\nresultado = 0\n\n# Soma todos os resultados em que a moeda foi \"Cara\"\nresultado = sum(sample(moeda, iteracoes, replace=T))\n\n# Divide o valor pela quantidade de itera\u00e7\u00f5es e transforma em percentual\nresultado = (resultado\/iteracoes) * 100\n\nreturn(resultado)\n}\n\n# Inicializa vari\u00e1veis\nvetor_resultado = 0\nvetor_tempo = 0\ncontrole = 0\n\n# Informa a quantidade de itera\u00e7\u00f5es a ser\u00e3o executadas\nrodadas = 100\n\n# Aloca os resultados percentuais em um vetor de 100 itens e aloca os tempos de execu\u00e7\u00e3o em outro\nwhile (controle != 100)\n{\ntempo_inicial = Sys.time()\nvetor_resultado = append(vetor_resultado, LancaMoeda(rodadas))\ntempo_final = Sys.time()\n\ntempo = tempo_final - tempo_inicial\nvetor_tempo = append(vetor_tempo, tempo)\n\ncontrole = controle + 1\n}\n\n# Mostra os percentuais\nvetor_resultado\n\n# Mostra os tempos de execu\u00e7\u00e3o\nvetor_tempo\n<\/code><\/pre>\n<p>Alterando os valores da vari\u00e1vel <em>itera\u00e7\u00f5es<\/em> e compilando os resultados obtive a seguinte tabela:<\/p>\n\n<table id=\"tablepress-1\" class=\"tablepress tablepress-id-1\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Itera\u00e7\u00f5es<\/th><th class=\"column-2\">Resultado Min<\/th><th class=\"column-3\">Resultado Max<\/th><th class=\"column-4\">Resultado Esperado<\/th><th class=\"column-5\">Resultado M\u00e9dio<\/th><th class=\"column-6\">Resultado M\u00e9dio - Resultado Esperado <\/th><th class=\"column-7\"> Mediana do Resultado<\/th><th class=\"column-8\"> Mediana Resultado - Resultado Esperado<\/th><th class=\"column-9\">Desvio-Padr\u00e3o do Resultado<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">33.00000<\/td><td class=\"column-3\">67.00000<\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.02000 <\/td><td class=\"column-6\">0.02000 <\/td><td class=\"column-7\">50.00000 <\/td><td class=\"column-8\">0.00000 <\/td><td class=\"column-9\">5.09368 <\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">43.60000<\/td><td class=\"column-3\">56.20000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99440 <\/td><td class=\"column-6\">0.00560 <\/td><td class=\"column-7\">50.00000 <\/td><td class=\"column-8\">0.00000 <\/td><td class=\"column-9\">1.59105 <\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">48.35000<\/td><td class=\"column-3\">51.78000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.01263 <\/td><td class=\"column-6\">0.01263 <\/td><td class=\"column-7\">50.02000 <\/td><td class=\"column-8\">0.02000 <\/td><td class=\"column-9\">0.51001 <\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">49.58000<\/td><td class=\"column-3\">51.78000 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99110 <\/td><td class=\"column-6\">0.00890 <\/td><td class=\"column-7\">49.99350 <\/td><td class=\"column-8\">0.00650 <\/td><td class=\"column-9\">0.15805 <\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">49.85170<\/td><td class=\"column-3\">50.15090 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99883 <\/td><td class=\"column-6\">0.00117 <\/td><td class=\"column-7\">49.99785 <\/td><td class=\"column-8\">0.00215 <\/td><td class=\"column-9\">0.04811 <\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">49.95433 <\/td><td class=\"column-3\">50.05807 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.00013 <\/td><td class=\"column-6\">0.00013 <\/td><td class=\"column-7\">50.00010 <\/td><td class=\"column-8\">0.00010 <\/td><td class=\"column-9\">0.01564 <\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">49.98435 <\/td><td class=\"column-3\">50.01637 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">50.00004 <\/td><td class=\"column-6\">0.00004 <\/td><td class=\"column-7\">49.99989 <\/td><td class=\"column-8\">0.00011 <\/td><td class=\"column-9\">0.00516 <\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">49.98890<\/td><td class=\"column-3\">50.01195 <\/td><td class=\"column-4\">50.00000 <\/td><td class=\"column-5\">49.99981 <\/td><td class=\"column-6\">0.00019 <\/td><td class=\"column-7\">49.99987 <\/td><td class=\"column-8\">0.00013 <\/td><td class=\"column-9\">0.00345 <\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-1 from cache -->\n<p>No caso de um problema simples, como o lan\u00e7amento de uma moeda, podemos ver que a quantidade ideal de itera\u00e7\u00f5es seria algo entre 10 e 100 milh\u00f5es de vezes. Visto que \u00e9 nessa faixa em que o desvio padr\u00e3o dos resultados come\u00e7a a ser na ordem da terceira casa decimal, outro ponto interessante \u00e9 que se voc\u00ea deseja mostrar apenas a primeira casa decimal um valor de 1 milh\u00e3o de itera\u00e7\u00f5es j\u00e1 atenderia.<\/p>\n<h3>O DADO<\/h3>\n<p>Com o teste da moeda podemos ter uma id\u00e9ia de quantas itera\u00e7\u00f5es s\u00e3o necess\u00e1rias, para cada grau de confiabilidade desejado. Por\u00e9m uma pergunta que fica \u00e9 se esse comportamento \u00e9 o mesmo para sistemas mais complexos. Por este motivo fiz um teste parecido, por\u00e9m agora rodando um dado de 6 lados, que tem <strong>16,67%<\/strong> de chances de cair em qualquer face.<\/p>\n<pre><code class=\"R\">RolaDado &lt;- function(iteracoes)\n{\n# Cria o vetor com os valores poss\u00edveis para o dado\ndado = 1:6\nresultado = 0\n\n# Aloca os resultados das rolagens do dado\nresultado = sample(dado,iteracoes,replace=T)\n\n# Soma todos os valores que tiverem sigo iguais a 6\nresultado = sum(resultado == 6)\n\n# Divide o valor pela quantidade de itera\u00e7\u00f5es e transforma em percentual\nresultado = (resultado\/iteracoes) * 100\n\nreturn(resultado)\n}\n\n# Inicializa vari\u00e1veis\nvetor_resultado = 0\nvetor_tempo = 0\ncontrole = 0\n\n# Informa a quantidade de itera\u00e7\u00f5es a ser\u00e3o executadas\nrodadas = 100\n\n# Aloca os resultados percentuais em um vetor de 100 itens e aloca os tempos de execu\u00e7\u00e3o em outro\nwhile(controle != 100)\n{\ntempo_inicial = Sys.time()\nvetor_resultado = append(vetor_resultado, RolaDado(rodadas))\ntempo_final = Sys.time()\n\ntempo = tempo_final - tempo_inicial\nvetor_tempo = append(vetor_tempo, tempo)\n\ncontrole = controle + 1\n}\n\n# Mostra os percentuais\nvetor_resultado\n\n# Mostra os tempos de execu\u00e7\u00e3o\nvetor_tempo\n<\/code><\/pre>\n<p>Alterando os valores da vari\u00e1vel <em>itera\u00e7\u00f5es<\/em> e compilando os resultados obtive a seguinte tabela:<\/p>\n\n<table id=\"tablepress-2\" class=\"tablepress tablepress-id-2\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Itera\u00e7\u00f5es<\/th><th class=\"column-2\">Resultado Min<\/th><th class=\"column-3\">Resultado Max<\/th><th class=\"column-4\">Resultado Esperado<\/th><th class=\"column-5\">Resultado M\u00e9dio<\/th><th class=\"column-6\">Resultado M\u00e9dio - Resultado Esperado <\/th><th class=\"column-7\"> Mediana do Resultado<\/th><th class=\"column-8\"> Mediana Resultado - Resultado Esperado<\/th><th class=\"column-9\">Desvio-Padr\u00e3o do Resultado<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">6.00000<\/td><td class=\"column-3\">28.00000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.58100<\/td><td class=\"column-6\">-0.08567<\/td><td class=\"column-7\">16.00000<\/td><td class=\"column-8\">-0.66667<\/td><td class=\"column-9\">3.64372<\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">13.20000<\/td><td class=\"column-3\">20.40000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.68500<\/td><td class=\"column-6\">0.01833<\/td><td class=\"column-7\">16.60000<\/td><td class=\"column-8\">-0.06667<\/td><td class=\"column-9\">1.16949<\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">15.60000<\/td><td class=\"column-3\">17.94000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.65962<\/td><td class=\"column-6\">-0.00705<\/td><td class=\"column-7\">16.67000<\/td><td class=\"column-8\">0.00333<\/td><td class=\"column-9\">0.38072<\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">16.22200<\/td><td class=\"column-3\">17.06200<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66109<\/td><td class=\"column-6\">-0.00557<\/td><td class=\"column-7\">16.66500<\/td><td class=\"column-8\">-0.00167<\/td><td class=\"column-9\">0.11356<\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">16.54960<\/td><td class=\"column-3\">16.54960<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66616<\/td><td class=\"column-6\">-0.00050<\/td><td class=\"column-7\">16.66790<\/td><td class=\"column-8\">0.00123<\/td><td class=\"column-9\">0.03650<\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">16.63294<\/td><td class=\"column-3\">16.70266<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66607<\/td><td class=\"column-6\">-0.00060<\/td><td class=\"column-7\">16.66577<\/td><td class=\"column-8\">-0.00090<\/td><td class=\"column-9\">0.01220<\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">16.65592<\/td><td class=\"column-3\">16.67948<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66670<\/td><td class=\"column-6\">0.00004<\/td><td class=\"column-7\">16.66679<\/td><td class=\"column-8\">0.00012<\/td><td class=\"column-9\">0.00372<\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">16.65787<\/td><td class=\"column-3\">16.67476<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66671<\/td><td class=\"column-6\">0.00004<\/td><td class=\"column-7\">16.66671<\/td><td class=\"column-8\">0.00004<\/td><td class=\"column-9\">0.00267<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-2 from cache -->\n<p>Podemos ver que neste caso tamb\u00e9m temos que a quantidade ideal de itera\u00e7\u00f5es seria algo entre 10 e 100 milh\u00f5es de vezes, para termos um erro a partir da segunda ou terceira casa decimal. Esse resultado mostra que, ou a complexidade do problema n\u00e3o tem influ\u00eancia na quantidade de itera\u00e7\u00f5es ou de que o problema da moeda e do dado t\u00eam complexidades parecidas. Analisando os tempos de execu\u00e7\u00f5es da moeda e do dado verifica-se que eles demoram tempos parecidos de execu\u00e7\u00e3o, o que corrobora a hip\u00f3tese de que os problemas tem complexidades pr\u00f3ximas.<\/p>\n<h3>DOIS DADOS<\/h3>\n<p>Para saber se a complexidade era muito pr\u00f3xima e por isso que os valores de itera\u00e7\u00f5es ideais ficaram iguais, decidi dobrar a complexidade do problema ao rodar <strong>dois<\/strong> dados em vez de <strong>um<\/strong> (entendo que nem sempre ao dobrar a quantidade de fun\u00e7\u00f5es teremos mais complexidade por conta da ordem de complexidade ou <a href=\"https:\/\/en.wikipedia.org\/wiki\/Big_O_notation\" target=\"_blank\" rel=\"noopener noreferrer\">Big-O Notation<\/a>, por\u00e9m fiz o teste para ter certeza se isso se aplicava). A maior probabilidade de resultado encontrada ao rolar dois dados \u00e9 o valor <strong>7<\/strong>, tendo <strong>16,67%<\/strong> de chances de ocorrer.<\/p>\n<pre><code class=\"R\">RolaDoisDados &lt;- function(iteracoes)\n{\n# Cria o vetor com os valores poss\u00edveis para o dado\ndado = 1:6\nresultado = 0\n\n# Aloca os resultados das rolagens dos dados\nprimeira_rolagem = sample(dado,iteracoes,replace=T)\nsegunda_rolagem = sample(dado,iteracoes,replace=T)\n\n# Soma os vetores, item a item\nresultado = primeira_rolagem + segunda_rolagem\n\n# Soma todos os valores que tiverem sigo iguais a 7\nresultado = sum(resultado == 7)\n\n# Divide o valor pela quantidade de itera\u00e7\u00f5es e transforma em percentual\nresultado = (resultado\/iteracoes) * 100\n\nreturn(resultado)\n}\n\n# Inicializa vari\u00e1veis\nvetor_resultado = 0\nvetor_tempo = 0\ncontrole = 0\n\n# Informa a quantidade de itera\u00e7\u00f5es a ser\u00e3o executadas\nrodadas = 100\n\n# Aloca os resultados percentuais em um vetor de 100 itens e aloca os tempos de execu\u00e7\u00e3o em outro\nwhile(controle != 100)\n{\ntempo_inicial = Sys.time()\nvetor_resultado = append(vetor_resultado, RolaDoisDados(rodadas))\ntempo_final = Sys.time()\n\ntempo = tempo_final - tempo_inicial\nvetor_tempo = append(vetor_tempo, tempo)\n\ncontrole = controle + 1\n}\n\n# Mostra os percentuais\nvetor_resultado\n\n# Mostra os tempos de execu\u00e7\u00e3o\nvetor_tempo\n<\/code><\/pre>\n<p>Novamente alterando os valores da vari\u00e1vel <em>itera\u00e7\u00f5es<\/em> e compilando os resultados:<\/p>\n\n<table id=\"tablepress-4\" class=\"tablepress tablepress-id-4\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Itera\u00e7\u00f5es<\/th><th class=\"column-2\">Resultado Min<\/th><th class=\"column-3\">Resultado Max<\/th><th class=\"column-4\">Resultado Esperado<\/th><th class=\"column-5\">Resultado M\u00e9dio<\/th><th class=\"column-6\">Resultado M\u00e9dio - Resultado Esperado <\/th><th class=\"column-7\"> Mediana do Resultado<\/th><th class=\"column-8\"> Mediana Resultado - Resultado Esperado<\/th><th class=\"column-9\">Desvio-Padr\u00e3o do Resultado<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">5.00000<\/td><td class=\"column-3\">31.00000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.37100<\/td><td class=\"column-6\">-0.29567<\/td><td class=\"column-7\">16.00000<\/td><td class=\"column-8\">-0.66667<\/td><td class=\"column-9\">3.77487<\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">13.40000<\/td><td class=\"column-3\">21.80000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.64710<\/td><td class=\"column-6\">-0.01957<\/td><td class=\"column-7\">16.60000<\/td><td class=\"column-8\">-0.06667<\/td><td class=\"column-9\">1.18550<\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">15.33000<\/td><td class=\"column-3\">17.77000<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.68307<\/td><td class=\"column-6\">0.01640<\/td><td class=\"column-7\">16.68500<\/td><td class=\"column-8\">0.01833<\/td><td class=\"column-9\">0.38059<\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">16.23100<\/td><td class=\"column-3\">17.06600<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66546<\/td><td class=\"column-6\">-0.00120<\/td><td class=\"column-7\">16.66800<\/td><td class=\"column-8\">0.00133<\/td><td class=\"column-9\">0.11597<\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">16.54450<\/td><td class=\"column-3\">16.81170<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66657<\/td><td class=\"column-6\">-0.00010<\/td><td class=\"column-7\">16.66860<\/td><td class=\"column-8\">0.00193<\/td><td class=\"column-9\">0.03798<\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">16.62888<\/td><td class=\"column-3\">16.70282<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66683<\/td><td class=\"column-6\"> 0.00016<\/td><td class=\"column-7\">16.66705<\/td><td class=\"column-8\">0.00038<\/td><td class=\"column-9\">0.01155<\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">16.65408<\/td><td class=\"column-3\">16.67899<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66669<\/td><td class=\"column-6\">0.00002<\/td><td class=\"column-7\">16.66673<\/td><td class=\"column-8\">0.00007<\/td><td class=\"column-9\">0.00382<\/td>\n<\/tr>\n<tr class=\"row-9\">\n\t<td class=\"column-1\">200000000<\/td><td class=\"column-2\">16.65881<\/td><td class=\"column-3\">16.67455<\/td><td class=\"column-4\">16.66667<\/td><td class=\"column-5\">16.66675<\/td><td class=\"column-6\">0.00009<\/td><td class=\"column-7\">16.66682<\/td><td class=\"column-8\">0.00015<\/td><td class=\"column-9\">0.00258<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-4 from cache -->\n<p>Novamente verificamos que uma quantidade de itera\u00e7\u00f5es entre 10 e 100 milh\u00f5es traz uma varia\u00e7\u00e3o baixa o suficiente para ser confi\u00e1vel. E nesse caso pude identificar que o problema era sim mais complexo, visto que o tempo de execu\u00e7\u00e3o para 200 milh\u00f5es de vezes levou em m\u00e9dia <strong>7,47 segundos a mais<\/strong> que o problema de um \u00fanico dado.<\/p>\n<h3>CINCO DADOS<\/h3>\n<p>A infer\u00eancia que tive at\u00e9 este momento \u00e9 de que a complexidade do problema influi muito pouco na quantidade de itera\u00e7\u00f5es a serem realizadas, mas para ter certeza eu fiz o teste com 5 dados. A maior probabilidade de resultado encontrada ao rolar cinco dados s\u00e3o os valores <strong>17<\/strong> e <strong>18<\/strong>, tendo <strong>10,03%<\/strong> de chances de ocorrer.<\/p>\n<pre><code class=\"R\">RolaCincoDados &lt;- function(iteracoes)\n{\n# Cria o vetor com os valores poss\u00edveis para o dado\ndado = 1:6\nresultado = 0\n\n# Aloca os resultados das rolagens dos dados\nprimeira_rolagem = sample(dado,iteracoes,replace=T)\nsegunda_rolagem = sample(dado,iteracoes,replace=T)\nterceira_rolagem = sample(dado,iteracoes,replace=T)\nquarta_rolagem = sample(dado,iteracoes,replace=T)\nquinta_rolagem = sample(dado,iteracoes,replace=T)\n\n# Soma os vetores, item a item\nresultado = primeira_rolagem + segunda_rolagem + terceira_rolagem + quarta_rolagem + quinta_rolagem\n\n# Soma todos os valores que tiverem sigo iguais a 18\nresultado = sum(resultado == 18)\n\n# Divide o valor pela quantidade de itera\u00e7\u00f5es e transforma em percentual\nresultado = (resultado\/iteracoes) * 100\n\nreturn(resultado)\n}\n\n# Inicializa vari\u00e1veis\nvetor_resultado = 0\nvetor_tempo = 0\ncontrole = 0\n\n# Informa a quantidade de itera\u00e7\u00f5es a ser\u00e3o executadas\nrodadas = 10\n\n# Aloca os resultados percentuais em um vetor de 100 itens e aloca os tempos de execu\u00e7\u00e3o em outro\nwhile(controle != 100)\n{\ntempo_inicial = Sys.time()\nvetor_resultado = append(vetor_resultado, RolaCincoDados(rodadas))\ntempo_final = Sys.time()\n\ntempo = tempo_final - tempo_inicial\nvetor_tempo = append(vetor_tempo, tempo)\n\ncontrole = controle + 1\n}\n\n# Mostra os percentuais\nvetor_resultado\n\n# Mostra os tempos de execu\u00e7\u00e3o\nvetor_tempo\n<\/code><\/pre>\n<p>Compilando os resultados:<\/p>\n\n<table id=\"tablepress-10\" class=\"tablepress tablepress-id-10\">\n<thead>\n<tr class=\"row-1\">\n\t<th class=\"column-1\">Itera\u00e7\u00f5es<\/th><th class=\"column-2\">Resultado Min<\/th><th class=\"column-3\">Resultado Max<\/th><th class=\"column-4\">Resultado Esperado<\/th><th class=\"column-5\">Resultado M\u00e9dio<\/th><th class=\"column-6\">Resultado M\u00e9dio - Resultado Esperado <\/th><th class=\"column-7\"> Mediana do Resultado<\/th><th class=\"column-8\"> Mediana Resultado - Resultado Esperado<\/th><th class=\"column-9\">Desvio-Padr\u00e3o do Resultado<\/th>\n<\/tr>\n<\/thead>\n<tbody class=\"row-hover\">\n<tr class=\"row-2\">\n\t<td class=\"column-1\"> 100<\/td><td class=\"column-2\">2.00000<\/td><td class=\"column-3\">20.00000<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.04300<\/td><td class=\"column-6\">0.01214<\/td><td class=\"column-7\">10.00000<\/td><td class=\"column-8\">-0.03086\t<\/td><td class=\"column-9\">3.01268<\/td>\n<\/tr>\n<tr class=\"row-3\">\n\t<td class=\"column-1\">1000<\/td><td class=\"column-2\">6.80000<\/td><td class=\"column-3\">13.40000<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.04160<\/td><td class=\"column-6\">0.01074<\/td><td class=\"column-7\">10.00000<\/td><td class=\"column-8\">-0.03086\t<\/td><td class=\"column-9\">0.96373<\/td>\n<\/tr>\n<tr class=\"row-4\">\n\t<td class=\"column-1\">10000<\/td><td class=\"column-2\">9.07000<\/td><td class=\"column-3\">11.03000<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.04600<\/td><td class=\"column-6\">0.01514\t<\/td><td class=\"column-7\">10.04500<\/td><td class=\"column-8\">0.01414<\/td><td class=\"column-9\">0.30501<\/td>\n<\/tr>\n<tr class=\"row-5\">\n\t<td class=\"column-1\">100000<\/td><td class=\"column-2\">9.74700<\/td><td class=\"column-3\">10.31500<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.02726<\/td><td class=\"column-6\">-0.00360\t<\/td><td class=\"column-7\">10.03100<\/td><td class=\"column-8\">0.00014<\/td><td class=\"column-9\">0.09366<\/td>\n<\/tr>\n<tr class=\"row-6\">\n\t<td class=\"column-1\">1000000 <\/td><td class=\"column-2\">9.95030<\/td><td class=\"column-3\">10.11240<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.02994<\/td><td class=\"column-6\">-0.00092\t<\/td><td class=\"column-7\">10.03045<\/td><td class=\"column-8\">-0.00041\t<\/td><td class=\"column-9\">0.02945<br \/>\n<\/td>\n<\/tr>\n<tr class=\"row-7\">\n\t<td class=\"column-1\">10000000<\/td><td class=\"column-2\">10.00060<\/td><td class=\"column-3\">10.06768<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.03072<\/td><td class=\"column-6\">-0.00014\t<\/td><td class=\"column-7\">10.03065\t<\/td><td class=\"column-8\">-0.00022\t<\/td><td class=\"column-9\">0.00956<\/td>\n<\/tr>\n<tr class=\"row-8\">\n\t<td class=\"column-1\">100000000<\/td><td class=\"column-2\">10.02151<\/td><td class=\"column-3\">10.04116<\/td><td class=\"column-4\">10.03086<\/td><td class=\"column-5\">10.03091<\/td><td class=\"column-6\">0.00004<\/td><td class=\"column-7\">10.03102<\/td><td class=\"column-8\">0.00016<\/td><td class=\"column-9\">0.00310<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<!-- #tablepress-10 from cache -->\n<p>E mais uma vez podemos ver que entre 10 e 100 milh\u00f5es \u00e9 valor ideal. Interessante notar que esse caso realmente foi mais complexo, levando <strong>35 segundos a mais<\/strong> em m\u00e9dia quando comparada com a rolagem de um \u00fanico dado.<\/p>\n<h2>Conclus\u00e3o<\/h2>\n<p>Depois de realizar todos esses testes, \u00e9 poss\u00edvel concluir que, para a utiliza\u00e7\u00e3o em gerenciamento de projetos, uma quantidade de itera\u00e7\u00f5es entre 10 e 100 milh\u00f5es atenderia adequadamente a necessidade de prever alguma data de entrega.<\/p>\n<p>O valor que tenho utilizado \u00e9 de 10 milh\u00f5es, quando vou passar os dados para algum <em>stakeholder<\/em>. Por\u00e9m como o processo fica demorado (em m\u00e9dia de 30 minutos para rodar com 10 milh\u00f5es), quando eu preciso verificar os dados no dia-a-dia utilizo algum valor menor (algo entre 100 mil a 1 milh\u00e3o).<\/p>\n<p>E voc\u00ea? Tem utilizado o m\u00e9todo? Se sim, quais valores de itera\u00e7\u00f5es t\u00eam usado para a an\u00e1lise? Os resultados obtidos tem tido valor para os <em>stakeholders<\/em> de seus projetos? Caso queira trocar experi\u00eancias, podemos iniciar um bate-papo por e-mail, atrav\u00e9s do endere\u00e7o <a href=\"mailto:gabriel.lopes@plataformatec.com.br\" target=\"_blank\" rel=\"noopener noreferrer\">gabriel.lopes@plataformatec.com.br<\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Um dos maiores motivos pelo qual qualquer metodologia de gerenciamento de projetos existe, \u00e9 trazer redu\u00e7\u00e3o de custos. O atraso de uma semana em um projeto, gera dois custos diferentes: O primeiro custo \u00e9 o custo das pessoas presentes no time do projeto, por terem que trabalhar por mais uma semana. J\u00e1 o segundo, trata-se &#8230; <a class=\"read-more-link\" href=\"https:\/\/blog.plataformatec.com.br\/2018\/12\/monte-carlo-na-pratica-encontrando-o-valor-de-iteracoes-ideal\/\">\u00bb<\/a><\/p>\n","protected":false},"author":69,"featured_media":9432,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"ngg_post_thumbnail":0,"footnotes":""},"categories":[3],"tags":[123,263],"aioseo_notices":[],"jetpack_sharing_enabled":true,"jetpack_featured_media_url":"https:\/\/blog.plataformatec.com.br\/wp-content\/uploads\/2019\/10\/monte-carlo-na-pratica-encontrando-o-valor-de-iteracoes-ideal.png","_links":{"self":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/8262"}],"collection":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/users\/69"}],"replies":[{"embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/comments?post=8262"}],"version-history":[{"count":15,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/8262\/revisions"}],"predecessor-version":[{"id":9446,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/posts\/8262\/revisions\/9446"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/media\/9432"}],"wp:attachment":[{"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/media?parent=8262"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/categories?post=8262"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/blog.plataformatec.com.br\/wp-json\/wp\/v2\/tags?post=8262"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}